## üß¨ Cross-Species Protein Comparison Analysis

This document explains the file structure and outputs generated by the Snakemake pipeline for **cross-species protein domain and phosphorylation site comparison** between *Arabidopsis thaliana* and a comparison organism. The analysis focuses on specific **target orthogroups (OGs)** derived from a list of target proteins (e.g., **ARF5, PLET2, WOX5** and **COP1, HY5, SPASTAR**).

---

## üìÇ File Tree Breakdown

The top-level directories organize the analysis based on the major steps of the pipeline, from data fetching and homology to prediction, comparison, and visualization.

| Directory | Purpose | Key Outputs and Contents |
| :--- | :--- | :--- |
| **domains** | **Protein Domain Prediction and Comparison** | Contains InterProScan results for domains and their cross-species comparisons. |
| **expression** | **Gene Expression Analysis (Optional)** | Stores downloaded single-cell expression data (if `GEO_IDENTIFIER` is provided) and the expression values for target genes. |
| **homology** | **Orthology Detection (OrthoFinder)** | Stores all results from the OrthoFinder analysis, which is the foundation for ortholog identification. |
| **intermediates** | **Pipeline Interim Files** | Holds processed files used to link major steps, such as the extracted target ortholog groups. |
| **phosphorylation** | **Phosphorylation Site Prediction and Comparison** | Contains MusiteDeep results for phosphorylation sites and their cross-species comparisons. |
| **summary** | **Final Summary Tables** | The final, collated results from the domain and phosphorylation site comparisons across all target orthogroups. |
| **trees** | **Target Gene Trees** | Stores phylogenetic trees (Newick format) specifically for the proteins in the target orthogroups. |
| **visualisation** | **Graphical Outputs** | Contains image files (SVG) for phylogenetic trees and phosphorylation site mapping. |

---

## üéØ Target-Specific Outputs

The directories **domains**, **phosphorylation**, **trees**, and **visualisation** contain subdirectories named after the specific target protein set used in the analysis (e.g., `ARF5_PLET2_WOX5`, `COP1_HY5_SPASTAR`).

### 1. `domains/TARGETS_FILE_STR`
| Directory/File | Output Type | Why It's Created |
| :--- | :--- | :--- |
| `OGXXXXXXX.tsv` | Raw **InterProScan** results | Result of `interproscan_predict` (Rule 4). Lists all predicted protein domains for every protein in the Orthogroup. |
| `OGXXXXXXX_comparison/` | Comparison directory | Result of `compare_interpro_pairs` (Rule 4). Contains files like `ProtA__vs__ProtB.tsv`, detailing the **domain similarities and differences** between orthologous protein pairs in the two main species. |

### 2. `phosphorylation/TARGETS_FILE_STR`
| Directory/File | Output Type | Why It's Created |
| :--- | :--- | :--- |
| `OGXXXXXXX_general_phosphorylation_SorT.txt` | Raw **MusiteDeep** S/T prediction | Result of `musitedeep_predict` (Rule 5). Lists predicted **Serine (S) and Threonine (T)** phosphorylation sites for all proteins in the Orthogroup. |
| `OGXXXXXXX_general_phosphorylation_Y.txt` | Raw **MusiteDeep** Y prediction | Result of `musitedeep_predict` (Rule 5). Lists predicted **Tyrosine (Y)** phosphorylation sites for all proteins in the Orthogroup. |
| `OGXXXXXXX_comparison/` | Comparison directory | Result of `compare_musitedeep_pairs` (Rule 5). Contains files like `ProtA__vs__ProtB_SorT.tsv`, detailing the **conservation and divergence of predicted phosphorylation sites** between orthologous protein pairs. |

### 3. `trees/TARGETS_FILE_STR`
| File | Output Type | Why It's Created |
| :--- | :--- | :--- |
| `OGXXXXXXX.txt` | Newick Tree File | Result of `extract_targets_trees` (Rule 3). Contains the **phylogenetic tree** for the proteins within that specific orthogroup, used for visualization. |

### 4. `visualisation/TARGETS_FILE_STR`
| File | Output Type | Why It's Created |
| :--- | :--- | :--- |
| `OGXXXXXXX_tree.svg` | SVG Image | Result of `visualize_tree` (Rule 10). A graphical representation of the **phylogenetic tree** including a depiction of multiple sequence alignment and predicted domains. |
| `OGXXXXXXX_SorT.svg` | SVG Image | Result of `visualize_phosphorilation_sites` (Rule 10). A graphical mapping of the **S/T phosphorylation sites** onto the protein sequences for the orthogroup. |
| `OGXXXXXXX_Y.svg` | SVG Image | Result of `visualize_phosphorilation_sites` (Rule 10). A graphical mapping of the **Y phosphorylation sites** onto the protein sequences for the orthogroup. |

---

## üó∫Ô∏è Homology (OrthoFinder) Outputs

The **homology** directory contains the core results of ortholog detection, generated by the `run_orthofinder` rule (Rule 2).

| Directory/File | Output Type | Why It's Created (OrthoFinder Output) |
| :--- | :--- | :--- |
| `Orthogroups/` | Orthogroup Definitions | Defines which genes belong to which orthogroup across all analyzed species. **Necessary for all downstream analyses.** |
| `Orthogroup_Sequences/` | FASTA files | FASTA files for all proteins in each orthogroup. **Used as input for InterProScan and MusiteDeep prediction.** |
| `Orthologues/` | Ortholog Pairs | TSV files detailing one-to-one, one-to-many, etc., ortholog relationships between specific species pairs. **Used as input for `extract_targets`.** |
| `MultipleSequenceAlignments/` | MSAs | Multiple sequence alignments of proteins within each orthogroup. **Used for phylogenetic tree construction and visualization.** |
| `Resolved_Gene_Trees/` | Gene Trees | Phylogenetic trees for all orthogroups. **Used to extract target trees.** |

---

## üìù Summary Outputs

The **summary** directory contains the final, integrated results (Rule 8):

| File | Output Type | Why It's Created |
| :--- | :--- | :--- |
| `TARGETS_FILE_STR_interpro_summary.tsv` | Summary Table | **Collated results for domain comparisons.** Provides a high-level view of domain conservation/divergence for all orthologous pairs across the target OGs. |
| `TARGETS_FILE_STR_musitedeep_summary_SorT.tsv` | Summary Table | **Collated results for S/T phosphorylation site comparisons.** Summarizes site conservation/divergence for all orthologous pairs. |
| `TARGETS_FILE_STR_musitedeep_summary_Y.tsv` | Summary Table | **Collated results for Y phosphorylation site comparisons.** Summarizes site conservation/divergence for all orthologous pairs. |
